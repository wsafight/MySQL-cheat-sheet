# 任务实例数量选配

假定当前服务器可以每秒处理大概 100 个请求 (100 QPS)。根据当前业务预计峰值流量会达到3470 QPS。为了处理这些流量，我们至少需要 35 个任务实例。

实际上，任务实例至少采用 37 个，也就是冗余度 N + 2。这是因为

- 在更新过程中，有一个任务实例将会短暂不可用，只有36 个实例可提供服务。
- 如果另外一个物理服务器同时也出现问题，那么另外一个任务实例也受到影响，只剩 35 个实例可以对外服务，则刚好可以满足峰值要求。

假设我们的用户峰值流量来自于全球。针对流量较大的地区，冗余度仍旧保持为 N + 2，而针对流量较小的地区，可以将冗余度由 N + 2 降低为 N + 1。这是因为在极端情况下可以牺牲一些用户体验以降低成本。

同时也要预留 1 个以上任务实例的空间以供更新使用。